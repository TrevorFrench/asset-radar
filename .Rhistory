#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
color = "#90EE90", linetype = "dotted", size = 1
)
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
color = "#90EE90", linetype = "dotted", size = 1
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85, run*.80)),
color = "#90EE90", linetype = "dotted", size = 1
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85, run*.80)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.83,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85, run*.80)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.80,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85, run*.80)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.825,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.80, run*.80, run*.85, run*.85, run*.80)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.82,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.85,run*.85)), color = "white", linetype = "dotted", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "0 G/L", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8, run*.75)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.82,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.85,run*.85)), color = "white", linetype = "dotted", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.85,
label = "0 G/L", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8, run*.75)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.82,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.85,run*.85)), color = "white", linetype = "dotted", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.85,
label = "0 G/L", hjust = 0, vjust = 0, size = 4, col = "white"
) +
# geom_rect(
#   aes(xmin = -run*.95, xmax = -run*.9, fill = "#90EE90"),
#   ymin = run*.80, ymax = run*.85, alpha = 0.2
# ) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8, run*.75)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.77,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
# TODO: ------------------------------------------------------------------------
# - CURRENTLY HAVE A TIME WEIGHTED AVERAGE, NEXT DO A VWAP
# LIBRARIES --------------------------------------------------------------------
library(ggplot2)
library(dplyr)
# DATASET ----------------------------------------------------------------------
df <- read.csv('pricing.csv')
data <- df[, c('id', 'start', 'o', 'h', 'l', 'c', 'v')]
data$start <- substr(data$start, 0, 10)
data$start <- as.Date(as.character(data$start), format = "%Y-%m-%d")
data <- data |> filter(id != 4587)
# CROSS-JOIN, FILTER, ADD FEATURES ---------------------------------------------
df2 <- cross_join(data, data)
df2 <- df2 %>%
mutate(diff = difftime(start.y, start.x, units = "days")) %>%
filter(diff >= 365)
df2 <- df2 |>
mutate("gain" = (h.y - l.x)/l.x) |>
mutate("loss" = (l.y - h.x)/h.x) |>
mutate("avg_gl" = (((c.y + o.y)/2)-((c.x + o.x)/2))/((c.x + o.x)/2))
# MIN/MAX CALCULATIONS ---------------------------------------------------------
gain <- df2 |> filter(gain == max(df2$gain))
gain_proceeds <- gain[1, 'h.y']
gain_gains <- gain_proceeds - gain[1,'l.x']
loss <- df2 |> filter(loss == min(df2$loss))
loss_proceeds <- loss[1,'l.y']
loss_gains <- loss_proceeds - loss[1,'h.x']
# DEVIANCE CALCULATIONS --------------------------------------------------------
lower_threshold <- quantile(df2$avg_gl, probs = c(.159))
lower_bound <- df2[which.min(abs(df2$avg_gl - lower_threshold)),]
lower_bound_proceeds <- (lower_bound[1,'c.y'] + lower_bound[1,'o.y']) / 2
lower_bound_gains <- lower_bound_proceeds - ((lower_bound[1,'c.x'] + lower_bound[1,'o.x'])/2)
upper_threshold <- quantile(df2$avg_gl, probs = c(.841))
upper_bound <- df2[which.min(abs(df2$avg_gl - upper_threshold)),]
upper_bound_proceeds <- (upper_bound[1,'c.y'] + upper_bound[1,'o.y']) / 2
upper_bound_gains <- upper_bound_proceeds - ((upper_bound[1,'c.x'] + upper_bound[1,'o.x'])/2)
# SET PLOT SCALE ---------------------------------------------------------------
run <- max(abs(loss_gains), abs(gain_gains))
x_range <- c(-run, run)
y_range <- c(0, run)
# DRAW THE PLOT ----------------------------------------------------------------
ggplot() +
geom_abline(slope = 100, intercept = 0, color = "white", linetype = "dotted") +
geom_abline(slope = lower_bound_proceeds/lower_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_abline(slope = upper_bound_proceeds/upper_bound_gains, intercept = 0, color = "#90EE90", linetype = "dashed", lwd = 1) +
geom_polygon(mapping=aes(x=c(0,lower_bound_gains/lower_bound_proceeds * run,upper_bound_gains/upper_bound_proceeds * run)
, y=c(0,run,run)),
fill = "#90EE90", alpha = 0.3) +
geom_abline(slope = gain_proceeds/gain_gains, intercept = 0, color = "#00c805", linetype = "solid", lwd = 1) +
geom_abline(slope = loss_proceeds/loss_gains, intercept = 0, color = "#ff5000", linetype = "solid", lwd = 1) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.95,run*.95)), color = "#ff5000", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.95,
label = "Minimum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.90,run*.90)), color = "#00c805", linetype = "solid", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.90,
label = "Maximum", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_line(aes(c(-run*.95,-run*.9),c(run*.85,run*.85)), color = "white", linetype = "dotted", lwd = 1) +
annotate(
geom = "text", x = -run*.89, y = run*.85,
label = "0 G/L", hjust = 0, vjust = 0, size = 4, col = "white"
) +
geom_polygon(mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8)),
fill = "#90EE90", alpha = 0.3) +
geom_path(
mapping = aes(x = c(-run*.95, -run*.9, -run*.9, -run*.95, -run*.95),
y = c(run*.75, run*.75, run*.8, run*.8, run*.75)),
color = "#90EE90", linetype = "dotted", size = 1
) +
annotate(
geom = "text", x = -run*.89, y = run*.77,
label = "1 sd (68.2%)", hjust = 0, vjust = 0, size = 4, col = "white"
) +
coord_cartesian(xlim = x_range, ylim = y_range, expand = 0) +
theme_void() +
theme(
panel.background = element_rect(fill = "black", color = "black", size = 0.5, linetype = "solid"),
legend.position = c(0.05, 0.95),
legend.justification = c(0, 1),
legend.background = element_rect(fill = "transparent")
)
shiny::runApp()
runApp()
View(data)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
